<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Speaker Clustering - Vakyansh</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">Vakyansh</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../data_collection/" class="dropdown-item">Data Collection Pipeine</a>
</li>
                                    
<li>
    <a href="../intelligent_data_pipelines/" class="dropdown-item">Intelligent Data Pipeline</a>
</li>
                                    
<li>
    <a href="../model_training/" class="dropdown-item">Model Training Pipeline</a>
</li>
                                    
<li>
    <a href="../crowdsource_platform/" class="dropdown-item">Crowdsourcing Platform</a>
</li>
                                    
<li>
    <a href="../adr/" class="dropdown-item">Architecture Decision Records</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Speaker Clustering</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../LICENSE" class="dropdown-item">License</a>
</li>
                                    
<li>
    <a href="../CONTRIBUTING/" class="dropdown-item">Contributions</a>
</li>
                                    
<li>
    <a href="../RELEASE_NOTES/" class="dropdown-item">Release notes</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../adr/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../LICENSE" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#speaker-clustering" class="nav-link">Speaker Clustering</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#table-of-contents" class="nav-link">Table of Contents</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#about-the-project" class="nav-link">About The Project</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#working" class="nav-link">Working</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#hyperparameters" class="nav-link">Hyperparameters</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="speaker-clustering">Speaker Clustering</h1>
<!-- TABLE OF CONTENTS -->
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#speaker-clustering">Speaker Clustering</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#about-the-project">About The Project</a></li>
<li><a href="#working">Working</a><ul>
<li><a href="#embeddings">Embeddings</a></li>
<li><a href="#clustering-algorithm">Clustering algorithm</a></li>
<li><a href="#merging-and-splitting">Merging and Splitting</a></li>
<li><a href="#fitting-noise-points">Fitting Noise points</a></li>
</ul>
</li>
<li><a href="#hyperparameters">Hyperparameters</a></li>
</ul>
<!-- ABOUT THE PROJECT -->
<h2 id="about-the-project">About The Project</h2>
<p>Speaker Clustering, or identification of spekaers in the wild is mainly useful for audio sources with no mapping between audios and a speaker label/name.</p>
<p>It is the task of identifying the unique speakers in a set of audio recordings (each belonging to exactly one speaker) without knowing who and how many speakers are present in the entire data. </p>
<p>Our intelligent data pipelines split each audio, based on Voice Activity Detection, as one of the starting steps. These shorter audio utterances are then used to train deep learning models. We assume that the utterances are short enough to have one speaker per utterance, since the splitting logic is using unvoiced segments as points to split an audio.</p>
<!-- WORKING -->
<h2 id="working">Working</h2>
<p>This documentation will help you understand the various steps involved and take you through the hyperparameters, so you can tune them to achieve the best possible results.</p>
<h3 id="embeddings">Embeddings</h3>
<p>We use the Voice Encoder model proposed <a href="https://arxiv.org/abs/1710.10467">here</a>, and implemented <a href="https://github.com/resemble-ai/Resemblyzer">here</a> for converting our audio utterances into fixed length embeddings.</p>
<p>Voice Encoder is speaker-discriminative model trained on a text-independent speaker verification task. Thus it allows us to derive a high-level representation of the voice present in an audio. An embedding is a 256 dimensional vector capable of summarizing the characteristics of the voice spoken.</p>
<h3 id="clustering-algorithm">Clustering algorithm</h3>
<p>Embeddings for a source are passed as a matrix for clustering to be performed using HDBSCAN.
If the number of embeddings are greater than the parameter <em>partial_set_size</em>, they are divided into multiple partial sets of this size. This step is done to reduce the computational cost of calculating cosine distances and other internal matrices in HDBSCAN for a matrix.</p>
<p>We use Hierarchical Density-Based Spatial Clustering of Applications with Noise (HDBSCAN) as our core clustering algorithm on each of these partial steps.
This step also classifies some points as noise points - meaning they couldn't be used up in any clusters formed for this partial set. We keep a record of all these noise points for each partial set.</p>
<h3 id="merging-and-splitting">Merging and Splitting</h3>
<p>We found in our experiments that some of the speakers had their clusters distributed as separate ones - even in one partial set. This step helps in allowing such clusters to merge. Merging is based on cosine similarity (94-96% similar clusters are merged repetitively).
Also, clusters for the same speaker but from different partial sets also get merged in this step.</p>
<p>For some sources in our experiments, big clusters usually contained very high diversity of speakers. Splitting is done on such bigger clusters to make sure we have high cluster purity. A cluster is called big if it has more than 3 times the average number of points across all clusters.
We also tried splitting a large cluster containing audios from one spekaer only and it was retianed as is. So this step should not affect large clusters for one speaker.
Splitting is achieved by using Leaf HDBSCAN clustering on the big clusters. This allows for more more fine grained clustering.</p>
<p>Repetitive merging is applied again after splitting to allow clusters with high cosine simialrities to be merged.</p>
<h3 id="fitting-noise-points">Fitting Noise points</h3>
<p>All the noise points - points which could not be put into a cluster, are allowed to merge with a clusters if they have a cosine similairy of &gt;= 80% with a noise point. This parameter is also configurable. </p>
<!-- HYPERPARAMETERS -->
<h2 id="hyperparameters">Hyperparameters</h2>
<ul>
<li>
<p>min_cluster_size: </p>
<ul>
<li>the smallest size grouping that you wish to consider a cluster</li>
</ul>
</li>
<li>
<p>min_samples: </p>
<ul>
<li>number of points required in the neighborhood of a point to be considered a core point</li>
<li>smallest value = 1, max value = min_cluster_size</li>
<li>smaller values of min_samples have an effect of lowering the number of noise points</li>
</ul>
</li>
<li>
<p>partial_set_size:</p>
<ul>
<li>number of utterances to treat as one set for clustering.</li>
</ul>
</li>
<li>
<p>fit_noise_on_similarity:</p>
<ul>
<li>cosine similarity between a noise point and a cluster, at which the point can be fit to a cluster.</li>
</ul>
</li>
<li>
<p>cluster_selection_method: can either be ‘eom’ or ‘leaf’</p>
<ul>
<li>'eom' or Excess of Mass is the default way of HDBSCAN working. </li>
<li>'leaf' will select leaf nodes from the tree, producing many small homogeneous clusters. Allowing for fine-grained clusters. This is used while splitting clsuters into smaller ones.</li>
</ul>
</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
